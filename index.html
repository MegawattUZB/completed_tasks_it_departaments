<!DOCTYPE html>
<html lang="ru">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Выполненные задачи</title>
		<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet" />
		<style>
			body {
			    font-family: 'Roboto', sans-serif;
			    background-color: #f7f9fc;
			    color: #333;
			    margin: 0;
			    padding: 0;
			    display: flex;
			    flex-direction: column;
			    align-items: center;
			}

			.container {
			    max-width: 1000px;
			    width: 100%;
			    padding: 20px;
			}

			h2 {
			    text-align: center;
			    color: #4CAF50;
			    margin-bottom: 20px;
			    font-size: 2.5em;
			    position: relative;
			}

			h2::after {
			    content: '';
			    display: block;
			    width: 50px;
			    height: 4px;
			    background-color: #4CAF50;
			    margin: 10px auto;
			    border-radius: 2px;
			}

			.card {
			    background: linear-gradient(145deg, #ffffff, #e6e6e6);
			    border: 1px solid #ddd;
			    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
			    padding: 20px;
			    margin: 20px 0;
			    border-radius: 12px;
			    transition: transform 0.3s ease, box-shadow 0.3s ease;
			    opacity: 0;
			    transform: translateY(20px);
			    animation: fadeInUp 0.5s forwards;
			}

			@keyframes fadeInUp {
			    to {
			        opacity: 1;
			        transform: translateY(0);
			    }
			}

			.card:hover {
			    transform: translateY(-10px);
			    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
			}

			.card-header {
			    font-weight: bold;
			    color: #444;
			    margin-bottom: 10px;
			    font-size: 1.4em;
			}

			.card-body {
			    display: flex;
			    flex-direction: column;
			}

			.card-body div {
			    margin: 10px 0;
			}

			.label {
			    font-weight: bold;
			    color: #555;
			}

			.label-value {
			    color: #666;
			    margin-left: 10px;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<h2>Выполненные задачи за 21.06.2024</h2>

			<div id="cardsContainer"></div>
		</div>

		<script>
			const requests = [{"Отдел":"IT-отдел","Апдейты":"https://xarid.uzex.uz/shop/product-details/12072206","Инициатор":"Нурхон Махмадиёров","Крайний срок":"2024-06-21","Ответственный":null,"Тема обращения":"Выставить услугу зарядки электромобилей на биржу","Описание задачи / проблемы":"Нужно выставить на биржу услугу для Green University на 8.5 млн сум."},{"Отдел":"Бухгалтерия","Апдейты":null,"Инициатор":"Ilhom Ibragimov","Крайний срок":"2024-06-21","Ответственный":["Риат"],"Тема обращения":"Откатить стадию","Описание задачи / проблемы":"Откатить стадию на выдан договор "},{"Отдел":"Бухгалтерия","Апдейты":null,"Инициатор":"Юлия Эргашбаева","Крайний срок":"2024-06-21","Ответственный":["Нурхон"],"Тема обращения":"Предоставить цифры для с/ф Юниленду","Описание задачи / проблемы":"Нужны цифры, по которым была зарядка предпродажных и тест-драйвовских машин, чтобы рассчитаться с Юнилендом."},{"Отдел":"Клиентский сервис","Апдейты":"Так же настроил и добавил ещё один лист за \"июль\"","Инициатор":"Яна Тарасова","Крайний срок":"2024-06-21","Ответственный":["Риат"],"Тема обращения":"Убрать лишние поля","Описание задачи / проблемы":"Убрать лишние столбцы в таблице \"работа с возражениями\" \n- время\n\nYana Tarasova, [21.06.2024 12:26]\n- Номер договора\n- дата договора \n- ВИН код\n- оценка удовлетворенности"},{"Отдел":"IT отдел","Апдейты":null,"Инициатор":"Риат Хуснутдинов ","Крайний срок":"2024-06-21","Ответственный":["Риат"],"Тема обращения":"Сделанные работы по фискализации ","Описание задачи / проблемы":"Загрузка данных о локациях:\n\nload_locations(headers): Запрашивает данные о локациях от API и сохраняет их в файл total_locaticon.json.\nПеремещает данные через курсоры и собирает все активные локации, пока не дойдет до конца списка (когда nextCursor будет None).\nУправление токенами доступа:\n\nstatus_token(): Проверяет текущий токен доступа из файла access_token.json на актуальность. Если токен истек, вызывает функцию для создания нового токена.\nnew_AccessToken(): Создает новый токен доступа с использованием API-ключа из конфигурационного файла config.json и сохраняет его в access_token.json.\nРабота с данными локаций и коннекторов:\n\nlocations(location, connector, headers): Находит и возвращает информацию о локации и коннекторе на основе их идентификаторов. Если данные не найдены, загружает локации заново и повторяет попытку.\nФормирование заголовков для запросов:\n\nheaders(): Создает и возвращает заголовки для запросов, включая актуальный токен доступа.\nСохранение данных:\n\nsave_data(data): Сохраняет переданные данные в файл without_last_cursor.json.\nОбработка транзакций:\n\ntransactions(headers): Запрашивает данные о транзакциях от API, начиная с заданного времени. Обрабатывает транзакции, преобразует данные и сохраняет их в файл transactions_edit.json.\nПроверяет успешность транзакций и игнорирует те, где нет заряда или суммы транзакции.\nВ случае возникновения ошибок JSON, пытается обновить токен доступа.\nОсновной цикл выполнения:\n\nВ блоке if __name__ == \"__main__\": начинается основной цикл выполнения скрипта. Он периодически вызывает функцию transactions(headers) каждые 30 секунд и обновляет заголовки, если требуется.\n\nполучили файлы для фискальных чеков, изучаю API\n\nЧто осталось из глобального:\n1. Реализация асинхронных запросов\n2. Формирование и привязка бд\n3. Провести тесты и узнать кол-во потребление \n4. Логирование данных\n5. Арендовать сервак и разместить туда проект\n\n\n\n"},{"Отдел":"IT отдел","Апдейты":"Инициализация и загрузка данных:\n\nЗагружаются данные из файла count.json, который содержит список неработающих (оффлайн) станций, сохранённых в предыдущих итерациях.\nПечатается количество неработающих станций, сохранённых в файле.\nОпределение заголовков для запросов:\n\nФункция headers() загружает access_token из файла access_token.json и формирует заголовки для HTTP-запросов.\nОсновной цикл:\n\nСкрипт входит в бесконечный цикл с интервалом ожидания в 5 секунд между итерациями.\nВ каждой итерации выполняется POST-запрос к API по URL https://network.ecofactor.eu/public/api/v1/operator/locations для получения списка всех станций с заданными параметрами.\nИз ответа API извлекаются идентификаторы станций, которые находятся в состоянии оффлайн (не онлайн).\nСравнение и обновление списка оффлайн станций:\n\nЕсли текущий список оффлайн станций отличается от сохранённого в count.json, скрипт обновляет сохранённый список, удаляя из него станции, которые теперь находятся онлайн.\nДля каждой новой оффлайн станции, которая не была в сохранённом списке, скрипт:\nДобавляет её идентификатор в список.\nФормирует текст сообщения с названием станции.\nОтправляет уведомление в Telegram с помощью функции send_message.\nСохранение обновлённого списка:\n\nПосле каждой итерации скрипт сохраняет обновлённый список оффлайн станций в файл count.json.","Инициатор":"Риат Хуснутдинов ","Крайний срок":"2024-06-24","Ответственный":["Риат"],"Тема обращения":"Статус offline станций","Описание задачи / проблемы":"Экофактор добавил поле online с 2 булевыми значениями True False.\nСейчас нужно дописать скрипт который будет вытаскивать данные используя токен. Так же это всё нужно синхронизировать, что бы они в один момент не ломали друг друга и не создавали новый токен каждый раз при запросе "},{"Отдел":"Отдел продаж","Апдейты":"https://xt-xarid.uz/procedure/3078552/core","Инициатор":"Хайрулло Зокиров","Крайний срок":"2024-06-21","Ответственный":["Нурхон"],"Тема обращения":"Выставить товар на xt-xarid.uz","Описание задачи / проблемы":"Клиент просит, чтобы мы выставили товар на биржу xt-xarid. Нужно там зарегаться и опубликовать товар. "},{"Отдел":"Бухгалтерия","Апдейты":null,"Инициатор":"Диана Юнусова","Крайний срок":"2024-06-21","Ответственный":["Риат"],"Тема обращения":"Изменить статус Тип обращения\t","Описание задачи / проблемы":"Изменить статус Тип обращения\t на звонок "},{"Отдел":"IT-отдел","Апдейты":null,"Инициатор":"Аваз Азизов","Крайний срок":"2024-06-21","Ответственный":["Аваз"],"Тема обращения":"Удалить уволенных сотрудников","Описание задачи / проблемы":"Изменить статус должности на \"Не работает\" уволенных менеджеров в ИзиСофт"},{"Отдел":"Бухгалтерия","Апдейты":null,"Инициатор":"Анна Лебединская","Крайний срок":"2024-06-21","Ответственный":["Аваз"],"Тема обращения":"Достать данные из изи софт","Описание задачи / проблемы":"Ситуация такая. 27 мая запустили новые условия кредитования для клиентов дилеров БЙД 2 банка - ОФБ и Ипотека.\nБЙД спрашивают, какой из этих банков более активный.\n\"BYD Maxsus taklifi\"ni taklif etayotgan 2 ta hamkor bankdan qaysi birining qamrov dajasi yuqori?\nпотом они спрашивают, какой процент клиентов пользовался автокредитом с января по июнь 2024 года.\nНадо вытащить те, которые были оплачены с помощью кредита от этих двух банков"},{"Отдел":"Бухгалтерия","Апдейты":null,"Инициатор":"Юлия Эргашбаева","Крайний срок":"2024-06-21","Ответственный":["Нурхон"],"Тема обращения":"Возмещение подарочных сертификатов ME","Описание задачи / проблемы":"Предоставить сумму подарочных сертификатов ME для дальнейшего их возмещения Юнилендом. Период - май. "},{"Отдел":"Отдел IT","Апдейты":"- Invalid reference in filter '0-0' on link before module '11': Variable '26.id' references not existing module '26'.\nПроблема была в фильтре хотел взять id несуществующего модуля поэтому и сломался. Изменил на действующий модуль ","Инициатор":"Make","Крайний срок":"2024-06-21","Ответственный":["Риат"],"Тема обращения":"🛑 Сбой в сценарии","Описание задачи / проблемы":"🛑 Сбой в сценарии Продажи (BYD Service) \n\nСсылка: https://eu1.make.com/131055/scenarios/2502598/logs/f236548e577f44d0bc7ebb21ea127d55"},{"Отдел":"Бухгалтерия","Апдейты":null,"Инициатор":"Диана Юнусова","Крайний срок":"2024-06-21","Ответственный":["Аваз"],"Тема обращения":"Добавление машин","Описание задачи / проблемы":"Добавить машины для инспекции и для ИзиСофт"},{"Отдел":"Отдел IT","Апдейты":null,"Инициатор":"Make","Крайний срок":"2024-06-21","Ответственный":["Риат"],"Тема обращения":"🛑 Сбой в сценарии","Описание задачи / проблемы":"🛑 Сбой в сценарии Возражения \n\nСсылка: https://eu1.make.com/131055/scenarios/2380554/logs/8bd92d1d07364b13b2e9e0d44b45666d"}];

			function formatDate(dateString) {
			    const date = new Date(dateString);
			    const day = String(date.getDate()).padStart(2, '0');
			    const month = String(date.getMonth() + 1).padStart(2, '0');
			    const year = date.getFullYear();
			    return `${day}.${month}.${year}`;
			}

			const cardsContainer = document.getElementById('cardsContainer');
			requests.forEach(request => {
			    const card = document.createElement('div');
			    card.classList.add('card');

			    card.innerHTML = `
			        <div class="card-header">Инициатор: ${request['Инициатор']}</div>
			        <div class="card-body">
			            <div><span class="label">Отдел:</span><span class="label-value">${request['Отдел']}</span></div>
			            <div><span class="label">Ответственный:</span><span class="label-value">${request['Ответственный'] ? request['Ответственный'] : '-'}</span></div>
			            <div><span class="label">Крайний срок:</span><span class="label-value">${formatDate(request['Крайний срок'])}</span></div>
			            <div><span class="label">Тема обращения:</span><span class="label-value">${request['Тема обращения']}</span></div>
			            <div><span class="label">Описание задачи / проблемы:</span><span class="label-value">${request['Описание задачи / проблемы']}</span></div>
			            <div><span class="label">Апдейты:</span><span class="label-value">${request['Апдейты'] ? request['Апдейты'] : ''}</span></div>
			        </div>
			    `;

			    cardsContainer.appendChild(card);
			});
		</script>
	</body>
</html>
